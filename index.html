<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Pre-Order for Fansign | GMMTV SHOP</title>
  <meta name="viewport" content="width=1024">
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@500&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Kanit', Arial, sans-serif;
      background: #f5f7fa;
      color: #222;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1050px;
      margin: 36px auto;
      background: #fff;
      border-radius: 18px;
      padding: 30px 50px 40px 50px;
      box-shadow: 0 3px 16px #e2e2e2;
    }
    h1 {
      font-size: 2.2rem;
      color: #222;
      text-align: center;
      margin-top: 0;
    }
    .alert {
      background: #fff2f2;
      color: #d42323;
      padding: 18px 0 6px 0;
      text-align: center;
      font-size: 1.3rem;
      font-weight: bold;
      border-radius: 18px;
      margin-bottom: 20px;
    }
    .desc {
      text-align: center;
      color: #f00;
      font-size: 1.05rem;
      margin-bottom: 18px;
      margin-top: -16px;
      font-weight: bold;
    }
    .products {
      display: flex;
      flex-wrap: wrap;
      gap: 30px 24px;
      justify-content: flex-start;
      margin-bottom: 34px;
    }
    .card {
      background: #f7f8fa;
      border-radius: 12px;
      box-shadow: 0 1px 6px #d8d8d8;
      padding: 18px 10px 20px 10px;
      width: 220px;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 4px;
    }
    .card img {
      border-radius: 8px;
      width: 200px;
      height: 300px;
      object-fit: cover;
      margin-bottom: 8px;
      box-shadow: 0 2px 10px #ececec;
    }
    .card .name {
      font-size: 1.1rem;
      font-weight: 600;
      text-align: center;
      margin: 4px 0 3px 0;
      color: #262626;
      min-height: 42px;
    }
    .card .price {
      font-size: 1rem;
      font-weight: bold;
      color: #fa6400;
      margin-bottom: 8px;
      margin-top: 1px;
    }
    .card select, .card input[type='number'] {
      margin-bottom: 7px;
      width: 95%;
      border-radius: 7px;
      border: 1px solid #dedede;
      padding: 5px 7px;
      font-size: 1rem;
    }
    .card button {
      background: #0aa85a;
      color: #fff;
      border: none;
      border-radius: 7px;
      padding: 7px 16px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.15s;
      margin-top: 5px;
    }
    .card button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    .cart {
      background: #fff8ec;
      border-radius: 18px;
      padding: 22px 24px 16px 24px;
      margin-bottom: 25px;
      border: 1.2px solid #fae0c0;
      box-shadow: 0 2px 8px #f7d5b0;
    }
    .cart-title {
      font-size: 1.18rem;
      font-weight: bold;
      color: #d18800;
      margin-bottom: 15px;
    }
    .cart-list {
      font-size: 1.05rem;
      margin-bottom: 14px;
    }
    .cart-list li {
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .cart-actions {
      display: flex;
      gap: 7px;
    }
    .cart-actions button {
      background: #ed2222;
      border: none;
      color: #fff;
      padding: 1px 9px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1.05rem;
      margin-left: 5px;
    }
    .total {
      font-size: 1.25rem;
      font-weight: bold;
      text-align: right;
      color: #009f3b;
      margin-bottom: 10px;
    }
    .confirm-section {
      background: #e7fff4;
      border-radius: 16px;
      padding: 19px 30px;
      text-align: center;
      margin-bottom: 24px;
      font-size: 1.13rem;
    }
    .confirm-section .copy-btn {
      margin-left: 10px;
      background: #ff9000;
      color: #fff;
      border: none;
      border-radius: 7px;
      padding: 4px 13px;
      cursor: pointer;
      font-size: 1rem;
    }
    .red-btn {
      background: #e33434 !important;
      color: #fff !important;
      font-weight: 600 !important;
      border-radius: 8px !important;
      padding: 9px 20px !important;
      font-size: 1.13rem !important;
      border: none !important;
      margin-bottom: 10px !important;
      margin-top: 5px;
      cursor: pointer;
      transition: background 0.17s;
      box-shadow: 0 1px 5px #f3b6b6;
    }
    .order-copy {
      margin: 0 auto 10px auto;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 10px;
      background: #f7f9fc;
      border-radius: 12px;
      padding: 15px 18px 10px 18px;
      width: fit-content;
      box-shadow: 0 1px 7px #e0e7ef;
    }
    textarea.order-detail {
      font-family: 'Kanit', Arial, sans-serif;
      font-size: 1.03rem;
      background: #fff;
      border-radius: 9px;
      border: 1.1px solid #ececec;
      width: 360px;
      min-height: 70px;
      resize: none;
      padding: 10px 9px;
      color: #3b3b3b;
    }
    .order-copy .copy-btn {
      height: 43px;
      margin-top: 1px;
    }
    @media (max-width: 1050px) {
      .container { padding: 12px; }
      .products { gap: 16px 7px; }
      .card { width: 96vw; }
      .order-copy { width: 92vw; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="alert">สินค้าทั้งหมดที่ซื้อจะไม่ได้รับคูปองไซน์</div>
    <div class="desc">* ทุกออเดอร์ลด 30% ทันที!</div>
    <h1>Pre-Order for Fansign</h1>
    <div class="products" id="products"></div>
    
    <div class="cart" id="cart" style="display:none;">
      <div class="cart-title">สรุปรายการสั่งซื้อ</div>
      <ul class="cart-list" id="cart-list"></ul>
      <div class="total" id="total"></div>
    </div>
    
    <div class="confirm-section" id="confirmSection" style="display:none;">
      <div style="color:#13895b;font-weight:bold;">
        พร้อมเพย์: <span id="ppay" style="font-size:1.19rem;">0917567358</span>
        <button class="copy-btn" onclick="copyPromptpay()">Copy</button><br>
        Kanyarat Nuchanart
      </div>
      <div style="color:#ea2424;font-size:1.23rem;margin:12px 0 7px 0;font-weight:bold;">
        สินค้าทั้งหมดที่ซื้อจะไม่ได้รับคูปองไซน์
      </div>
      <a href="https://forms.gle/rs8wSC7psGdwheE39" target="_blank" class="red-btn">กรอกฟอร์มยืนยันโอนเงินที่นี่</a>
      <div class="order-copy">
        <textarea class="order-detail" id="orderDetail" readonly></textarea>
        <button class="copy-btn" onclick="copyOrder()">Copy รายการ</button>
      </div>
    </div>
  </div>
  <script>
    // --- Full Artists List ---
    const gmmtvArtists = [
      "Krist Perawat","Singto Prachaya","Off Jumpol","Gun Atthaphan","Tay Tawan","New Thitipoom","Earth Pirapat","Mix Sahaphap","Book Kasidet","Force Jiratchapong","Joong Archen","Dunk Natachai","Gemini Norawit","Fourth Nattawat","Winny Thanawin","Satang Kittiphop","Pond Naravit","Phuwin Tangsakyuen","Jimmy Jitaraphol","Sea Tawinan","Louis Thanawin","Mark Pakin","Mike Chinnarat","Aou Thanaboon","Boom Tham","Pepper Phanuroj","Fluke Pusit","Noon Siritorn","Euro Yotsawat","Prame Pumipat","Poom Patadon","Boss Chaikamon",
      "Mook Worranit","View Benyapa","June Wanwimol","Fah Yongwaree","Prim Chanikarn","Namtan Tipnaree","Aye Sarunchana","Mook Monchanok","Ciize Apichaya","Foei Patara","Love Pattranite","Film Rachanun","Earn Preeyaphat","Piploy Kanyarat","Aom Sushar","Pim Pimprapa","Benz Natthida","Pimnitcha","Ticha Wongthipkanon",
      "KristSingto","OffGun","TayNew","EarthMix","BookForce","JoongDunk","GeminiFourth","WinnySatang","PondPhuwin","JimmySea",
      "FahPrim","LoveFilm","NamtanFilm","JuneView","AyeCiize","EarnPiploy","MookMook",
      "KristMook","WinnyPrim","GeminiPrim","GunFah","OffNamtan","TayCiize","EarthPim","MixLove","BookFilm","ForceAye",
      "Sizzy","LYKN","KAZZ Magazine","TRINITY","Girl Next Door","The Gifted","Safe House","Friend Zone"
    ];

    // --- ตัวอย่างสินค้า (แก้/เพิ่ม/ลบได้ตามรูป) ---
    const products = [
      { id: 1, name: "That Summer Novel", price: 315, image: "images/that_summer.jpg" },
      { id: 2, name: "Burnout Syndrome Novel", price: 315, image: "images/burnout.jpg" },
      { id: 3, name: "Last Twilight Novel", price: 315, image: "images/last_twilight.jpg" },
      { id: 4, name: "Thamepo Heart Novel", price: 345, image: "images/thamepo.jpg" },
      { id: 5, name: "Ceri Doll Keychain", price: 555, image: "images/ceri_doll_keychain.jpg" },
      { id: 6, name: "Nilkhnake Doll Keychain", price: 555, image: "images/nilkhnake_doll_keychain.jpg" },
      { id: 7, name: "Collectible Card Set", price: 210, image: "images/collectible_card_set.jpg", artists: ["ALMONDPROGRESS", "VIEWMIM", "JUNEMEWNICH"] },
      { id: 8, name: "Customizable Acrylic Keychain", price: 245, image: "images/acrylic_keychain.jpg", artists: gmmtvArtists },
      { id: 9, name: "Fandom Phone Grippy (Random)", price: 203, image: "images/phone_grippy.jpg", grippyBox: ["A", "B"], artists: [
        // รวมชื่อทั้งหมด (ตัวอย่าง, ใส่ชื่อตาม box A/B ได้)
        "Babi","Pokchan","Paddy","Tomayok","Jadee","Avocani","Samuray","Domia","Jjamo","Gunzy","Ceri","Mavvy","Lunai","Any",
        "King Man","Mr. Saturnworld","Pernpoon","Yuzu Mumu","Look Khunkoo","Nong Noknok","Angelo","Wesley","Momo","Meta","Nilkhnake","Bayle","Nigma","Lykov"
      ]},
      { id: 10, name: "Magsafe Wallet Stand", price: 345, image: "images/magsafe_wallet.jpg", artists: gmmtvArtists },
      { id: 11, name: "Sticker Set", price: 155, image: "images/sticker_set.jpg", artists: gmmtvArtists },
      { id: 12, name: "Hair Band", price: 345, image: "images/hair_band.jpg", artists: gmmtvArtists },
      { id: 13, name: "Huggy Bag", price: 415, image: "images/huggy_bag.jpg", artists: gmmtvArtists },
      { id: 14, name: "Collectible Card Album", price: 210, image: "images/card_album.jpg", artists: gmmtvArtists },
      { id: 15, name: "Sticky Fabric", price: 205, image: "images/sticky_fabric.jpg", artists: gmmtvArtists },
      { id: 16, name: "Clear Pouch", price: 245, image: "images/clear_pouch.jpg", artists: gmmtvArtists },
      { id: 17, name: "Charm Illusion Tote Bag", price: 625, image: "images/charm_illusion_tote.jpg" },
      { id: 18, name: "Patchy Illusion Tote Bag", price: 625, image: "images/patchy_illusion_tote.jpg" }
    ];

    // --- DOM Render สินค้า ---
    const productsDiv = document.getElementById("products");
    let cart = [];

    function renderProducts() {
      productsDiv.innerHTML = "";
      products.forEach((p, idx) => {
        let artistOpt = "";
        if (p.artists) {
          artistOpt = `<select id="artist-${p.id}">
              <option value="">เลือกศิลปิน/คู่/กลุ่ม</option>
              ${p.artists.map(a => `<option value="${a}">${a}</option>`).join('')}
            </select>`;
        } else if (p.grippyBox) {
          artistOpt = `
            <select id="grippyBox-${p.id}" style="margin-bottom:7px;">
              <option value="">เลือก Box</option>
              ${p.grippyBox.map(box => `<option value="${box}">Box ${box}</option>`).join('')}
            </select>
            <select id="artist-${p.id}">
              <option value="">เลือกคาแรกเตอร์</option>
              ${p.artists.map(a => `<option value="${a}">${a}</option>`).join('')}
            </select>
          `;
        }
        productsDiv.innerHTML += `
          <div class="card" id="card-${p.id}">
            <img src="${p.image}" alt="${p.name}">
            <div class="name">${p.name}</div>
            <div class="price">${p.price}฿</div>
            ${artistOpt || ""}
            <button id="addBtn-${p.id}" onclick="addToCart(${p.id})">+ เพิ่ม</button>
          </div>
        `;
      });
    }

    function addToCart(id) {
      const p = products.find(x => x.id === id);
      let artist = "";
      let grippyBox = "";

      // Check for artist selection if exists
      if (p.artists) {
        const sel = document.getElementById("artist-"+p.id);
        if (sel && !sel.value) return alert("กรุณาเลือกศิลปิน/คู่/กลุ่ม");
        artist = sel ? sel.value : "";
      }
      if (p.grippyBox) {
        const selBox = document.getElementById("grippyBox-"+p.id);
        if (selBox && !selBox.value) return alert("เลือก Box ก่อน");
        grippyBox = selBox ? selBox.value : "";
        const sel = document.getElementById("artist-"+p.id);
        if (sel && !sel.value) return alert("เลือกคาแรกเตอร์");
        artist = sel.value;
      }
      // ตรวจสอบซ้ำ
      const foundIdx = cart.findIndex(item => item.id===id && item.artist===artist && item.grippyBox===grippyBox);
      if (foundIdx > -1) {
        cart[foundIdx].qty++;
      } else {
        cart.push({ id, name: p.name, price: p.price, qty: 1, artist, grippyBox });
      }
      renderCart();
    }

    function renderCart() {
      const cartDiv = document.getElementById("cart");
      const cartList = document.getElementById("cart-list");
      const totalDiv = document.getElementById("total");
      cartDiv.style.display = cart.length ? "block" : "none";
      if (!cart.length) {
        document.getElementById("confirmSection").style.display = "none";
        return;
      }
      let total = 0;
      cartList.innerHTML = "";
      cart.forEach((item, idx) => {
        const title = `${item.name}${item.grippyBox ? " (Box "+item.grippyBox+")":""}${item.artist ? " ("+item.artist+")":""}`;
        cartList.innerHTML += `
          <li>
            <span>${title} x ${item.qty} = ${(item.price*item.qty).toLocaleString()} บาท</span>
            <span class="cart-actions">
              <button onclick="changeQty(${idx},-1)">-</button>
              <button onclick="changeQty(${idx},1)">+</button>
              <button onclick="removeItem(${idx})">&times;</button>
            </span>
          </li>
        `;
        total += item.price * item.qty;
      });
      totalDiv.innerHTML = `รวมทั้งหมด: <span style="color:#d42323;">${total.toLocaleString()}</span> บาท`;
      // Render confirm section
      renderConfirmSection(total);
    }
    function changeQty(idx, delta) {
      cart[idx].qty += delta;
      if (cart[idx].qty <= 0) cart.splice(idx,1);
      renderCart();
    }
    function removeItem(idx) {
      cart.splice(idx,1);
      renderCart();
    }

    function renderConfirmSection(total) {
      const cs = document.getElementById("confirmSection");
      cs.style.display = "block";
      document.getElementById("orderDetail").value = cart.map(item =>
        `${item.name}${item.grippyBox?" (Box "+item.grippyBox+")":""}${item.artist?" ("+item.artist+")":""} x ${item.qty} = ${(item.price*item.qty).toLocaleString()} บาท`
      ).join('\n') + `\nรวมทั้งหมด: ${total.toLocaleString()} บาท`;
      document.getElementById("ppay").textContent = "0917567358";
    }
    function copyPromptpay() {
      navigator.clipboard.writeText("0917567358");
      alert("คัดลอกเบอร์พร้อมเพย์แล้ว!");
    }
    function copyOrder() {
      const txt = document.getElementById("orderDetail").value;
      navigator.clipboard.writeText(txt);
      alert("คัดลอกข้อความเรียบร้อย! นำไปวางในฟอร์มยืนยันได้เลย");
    }

    renderProducts();
  </script>
</body>
</html>
